(function(a){a.connectionPlay=function(b){var e=this;this.connItem=null;this.secId=null;this.connParentItem=null;this.connTime=null;this.thelevel=null;b=a.extend({},a.connectionPlay.options,{},b);if(b.courseId==null||a.trim(b.courseId)==""){return null}function d(){if(!b.saveLearningItemTimeStatus.call(this)){return}if(typeof b.setItem=="function"){this.connItem=b.setItem.call(this)}if(typeof b.setVideoTime=="function"){this.connTime=b.setVideoTime.call(this);if(!this.connTime||this.connTime==""||this.connTime==null||this.connTime<1){this.connTime=1}if(this.connTime.toString().indexOf(".")>-1){this.connTime=this.connTime.toString().split(".")[0]}}if(this.connItem!=null||this.connTime!=null){var k=false;var f=navigator.userAgent.toLowerCase();if(f.indexOf("chrome")!==-1){var m=f.match(/chrome\/([\d.]+)/)[1];var g=m.indexOf(".");if(g!==-1){var i=m.substring(0,g);if(parseInt(i)>=78){k=true}}else{if(f.indexOf("chrome/8")!==-1){k=true}}}if(f.indexOf("safari")>-1&&f.indexOf("chrome")===-1){var l=f.match(/version\/([\d.]+)/)[1];var h=l.substring(0,l.indexOf("."));if(parseInt(h)>=13){k=true}}if(k){var j=new Image(1,1);var n=b.updateUrl+"?params.courseId="+b.courseId+"&params.itemId="+this.connItem+"&params.videoTime="+Math.max(this.connTime-2,0);j.src=n;setTimeout(function(){},1000)}else{a.ajax({url:b.updateUrl,data:{"params.courseId":b.courseId,"params.itemId":this.connItem,"params.videoTime":Math.max(this.connTime-2,0)},dataType:"json",type:"post",async:false,cache:false,success:function(o){}})}}}function c(){if(!b.queryLearningItem.call()){return}a.ajax({url:b.initUrl,data:{"params.courseId":b.courseId},dataType:"json",type:"post",async:false,cache:false,success:function(f){if(f.data.itemId!=undefined){e.connItem=f.data.itemId}if(f.data.parentId!=undefined){e.connParentItem=f.data.parentId}if(f.data.videoTime!=undefined){e.connTime=f.data.videoTime}if(f.data.level!=undefined){e.level=f.data.level}if(f.data.secId!=undefined){e.secId=f.data.secId}}})}a(window).on("beforeunload",function(){d()});c();return e};a.connectionPlay.options={updateUrl:getPlatformRootPath()+"/learn/learnCourseware/saveLearningItem.json",initUrl:getPlatformRootPath()+"/learn/learnCourseware/queryLearningItem.json",courseId:null,minPlayTimeLong:3,setItem:function(){return null},setVideoTime:function(){return null},saveLearningItemTimeStatus:function(){return true},queryLearningItem:function(){return true}}})(jQuery);function getPlatformRootPath(){var c=window.document.location.href;var e=window.document.location.pathname;var d=c.indexOf(e);var a=c.substring(0,d);var b=e.substring(0,e.substr(1).indexOf("/")+1);return(a+b)};