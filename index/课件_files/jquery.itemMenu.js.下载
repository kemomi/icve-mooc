(function(a){a.itemMenu=function(e,j){if(e!=undefined&&e!=null){j=a.extend({},a.itemMenu.options,{},j);a(e).createMenuTool();var h=j.x;var g=j.y;function d(m,k,l){a(m).mouseover(function(o){a(this).addClass("menubu1");var n="<div id='tooltip'>";n+="<div class='wz'>";n+="<h3>"+k+"</h3>";if(l!=undefined&&l!=null&&l!="null"){if(l.length>140){l=l.substring(0,140)+"..."}n+="<p>"+l+"</p>"}n+="</div>";n+="</div>";a("body").append(n);a("#tooltip").css({top:a(m).children().offset().top+g+"px",left:a(m).children().offset().left+h+"px"}).show("fast")}).mouseout(function(){a(this).removeClass("menubu1");a("#tooltip").remove()})}function i(m){var k=0;for(var l=0;l<m.length;l++){var n=m.charCodeAt(l);if((n>=1&&n<=126)||(65376<=n&&n<=65439)){k+=0.75}else{k+=1}}return k}function b(k,l){if(k!=undefined&&k!=null&&k!=""){a.ajax({type:"POST",async:false,data:l,url:k,dataType:"json",success:function(n){var u=n.data;var p="";if(u!=null&&u.length>0){for(var o=0;o<u.length;o++){var m=u[o];var s=a.getItemObject(m.peWorkroomColumn.typt);var v=a("<div />",{id:"menu_"+m.id,menuType:m.peWorkroomColumn.typt,"class":"menub s"+(o+1),menuFlag:s.itemName});var q=m.title;v.append('<div class="'+s.buttonClass+'" >'+q+"</div>");if(o==0){v.addClass("first menubu ")}else{if(o+1==u.length){v.addClass("last")}}var w=m.title;var r=m.note;var t=m.peWorkroomColumn.typt;if(t=="text"||t=="link"){r=null}if(w==null||w==""||w=="undefined"){w="该节点下无内容"}d(v,w,r);a(e).find(".menuct").append(v)}}else{if(typeof j.noContentCallback==="function"){j.noContentCallback.call(this,n)}}}})}}b(j.dataUrl,j.params);var f=a(".menub").size();if(f>6){a(".rightbreak").css("display","block")}var c=630/f;if(f<6){a(".menub").css("width",c)}else{a(".menub").css("width","105px")}a(".menub").each(function(){var l=a(this).width();var m=a(this).text();var n=i(m)*12;var k=l-26-7;if(k>n){k=n}a(this).find("div[class^='m']").width(k)});a(".menub").click(function(){var l=a(".menubu");if(l){var p=a("#nav div ul .select");p.find("a").each(function(){a(this).css("color","#317c0c")})}a(".menub").removeClass("menubu");a(this).addClass("menubu");if(typeof j.menuClick!=="undefined"&&typeof j.menuClick==="function"){var m=a(this).attr("menuType");var q=a(this).attr("id").substring("menu_".length);var o=a.getItemObject(m);j.menuClick(this,q,o)}var n=a(".menub:visible:eq(0)");if(n.hasClass("menubu")){n.prev(".menub").show();if(f>6){a(".rightbreak").show()}if(a(".menubu").index(".menub")==1){a(".leftbreak").hide()}}var k=a(".menub:visible:eq(5)");if(k.hasClass("menubu")&&k.index(".menub")!=f-1){a(".menub:visible:eq(0)").hide();a(".leftbreak").show();if(a(".menubu").index(".menub")==f-2){a(".rightbreak").hide()}}});if(j.defaultMenu!=null&&j.defaultMenu!=""&&a("#menu_"+j.defaultMenu).length>0){a("#menu_"+j.defaultMenu).click()}else{a(".menub:eq(0)").click()}a("#rtarr").click(function(){var l=a(".menubu");if(l.hasClass("last")){}else{if(l.index()>5&&!l.hasClass("last")&&a(".menubu").index(".menub:visible")==5){if(l.index()==f){}else{a(a(".menub:visible").get(0)).hide();a(".leftbreak").show()}}var k=a(".menubu").next();a(k).addClass("menubu");a(".menubu").first().removeClass("menubu");a(k).click()}if(a(".menubu").index(".menub")>=f-2){a(".rightbreak").hide()}});a("#ltarr").click(function(){var l=a(".menubu");if(l.hasClass("first")){}else{if(a(".menub:visible").get(1)&&!l.hasClass("fist")){a((a(".menubu").prev()).prev(".menub")).show();if(a(".menubu").index(".menub")==2){a(".leftbreak").hide()}else{}}var k=a(".menubu").prev();a(k).addClass("menubu");a(".menubu").last().removeClass("menubu");a(k).click()}if(a(".menubu").index(".menub")<f-6){if(f<6){}else{a(".rightbreak").show()}}})}};a.fn.createMenuTool=function(){return this.each(function(){a(this).empty();var b="";b+='	 <iframe class="menuframebt" frameborder="0" width="720" height="48" scrolling="none"></iframe>';b+='  <div class="menuwrap">';b+=' 	<div class="menublank"></div>';b+=' 	<div class="menum">';b+='        <div class="ltarr" id="ltarr"></div>';b+='        <div class="menuct">';b+='        		<div class="rightbreak">…</div>';b+='        		<div class="leftbreak">…</div>';b+="        </div>";b+='        <div class="rtarr" id="rtarr"></div>';b+="    </div>";b+=" </div>";a(this).html(b)})};a.fn.itemMenu=function(b){return this.each(function(){a.itemMenu(this,b)})};a.itemMenu.options={x:-10,y:30,dataUrl:"",params:{},defaultMenu:"",menuClick:function(c,d,b){},noContentCallback:function(){},platformPath:function(){var d=window.document.location.href;var f=window.document.location.pathname;var e=d.indexOf(f);var b=d.substring(0,e);var c=f.substring(0,f.substr(1).indexOf("/")+1);return(b+c)}}})(jQuery);